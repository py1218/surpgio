---
import { Image } from "astro:assets";
import { QUOTE, SITE_TITLE } from "@/consts";
---

<div
  class="fixed inset-0 -z-10 bg-cover bg-center"
  style="background-image:url('/surpgio_background.png');"
></div>

<section
  id="game"
  class="relative flex flex-col items-center justify-center w-full min-h-[80dvh] sm:min-h-[70dvh] px-4 sm:px-6 py-8 sm:py-10 z-20"
>
  <!-- Message -->
  <div
    class="text-center text-white neon-pink"
    role="status"
    aria-live="polite"
  >
    <h1 class="font-semibold leading-tight [text-wrap:balance] text-[clamp(18px,4vw,28px)]">
      Currently unavailable
    </h1>
    <p class="mt-3 text-white/85 text-[clamp(14px,3.2vw,18px)]">
      Stay tuned for updates from pbrain studios.
    </p>
  </div>

  <!-- Email signup -->
  <div class="mt-6 w-full max-w-lg">
    <form
      name="contact"
      netlify
      data-contact-form
      class="flex flex-col sm:flex-row gap-3 sm:gap-2 items-stretch"
    >
      <!-- Netlify fields -->
      <input type="hidden" name="form-name" value="contact" />
      <input type="hidden" name="subject" value="SURPG Updates Signup" />
      <input type="hidden" name="message" value="User requested email updates for SURPG." />
      <input type="hidden" name="source" value="game_coming_soon_page" />

      <label for="updates-email" class="sr-only">Email address</label>
      <input
        id="updates-email"
        name="email"
        type="email"
        required
        placeholder="Enter your email for updates"
        autocomplete="email"
        inputmode="email"
        class="min-w-0 flex-1 rounded-xl px-4 py-3 text-[16px] text-black/90 placeholder-black/50 focus:outline-none focus:ring-2 focus:ring-[#6c5ce7]"
      />

      <button
        type="submit"
        class="rounded-xl px-5 py-3 font-semibold text-white w-full sm:w-auto transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#6c5ce7]"
        style="background-color:#6c5ce7;"
      >
        Notify Me
      </button>
    </form>

    <div
      class="thankyou mt-4 text-center font-semibold text-[#81ecec] text-[clamp(14px,3vw,16px)]"
      style="display:none;"
    >
      Thanks! Youâ€™re on the list. ðŸ’Œ
    </div>

    <p class="mt-3 text-center text-white/70 text-[clamp(12px,3vw,14px)]">
      Weâ€™ll only email you about SURPG updates. You can unsubscribe anytime.
    </p>
  </div>
</section>

<script type="module">
  const enhanceForm = (form) => {
    const thankyou = form.parentElement.querySelector('.thankyou');

    const handleSubmit = (event) => {
      event.preventDefault();
      const myForm = event.target;
      const formData = new FormData(myForm);

      fetch("/", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: new URLSearchParams(formData).toString()
      })
      .then(() => {
        myForm.style.display = "none";
        if (thankyou) thankyou.style.display = "block";
      })
      .catch(error => alert(error));
    };

    form.addEventListener("submit", handleSubmit);
  };

  window.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('form[data-contact-form]').forEach(enhanceForm);
  });
</script>
